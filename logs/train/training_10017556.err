2025-03-24 22:00:52,371 - INFO - Starting training...
Map:   0%|          | 0/51280 [00:00<?, ? examples/s]Map:   8%|▊         | 4000/51280 [00:00<00:01, 26996.11 examples/s]Map:  16%|█▌        | 8000/51280 [00:00<00:01, 28670.31 examples/s]Map:  23%|██▎       | 12000/51280 [00:00<00:01, 19643.93 examples/s]Map:  31%|███       | 16000/51280 [00:00<00:01, 22596.65 examples/s]Map:  39%|███▉      | 20000/51280 [00:00<00:01, 24739.83 examples/s]Map:  47%|████▋     | 24000/51280 [00:00<00:01, 26228.77 examples/s]Map:  55%|█████▍    | 28000/51280 [00:01<00:00, 27229.24 examples/s]Map:  62%|██████▏   | 32000/51280 [00:01<00:00, 28028.67 examples/s]Map:  70%|███████   | 36000/51280 [00:01<00:00, 28529.51 examples/s]Map:  78%|███████▊  | 40000/51280 [00:01<00:00, 28836.97 examples/s]Map:  84%|████████▍ | 43000/51280 [00:01<00:00, 21765.34 examples/s]Map:  92%|█████████▏| 47000/51280 [00:01<00:00, 23812.87 examples/s]Map:  99%|█████████▉| 51000/51280 [00:02<00:00, 25361.07 examples/s]Map: 100%|██████████| 51280/51280 [00:02<00:00, 25230.09 examples/s]
Map:   0%|          | 0/5334 [00:00<?, ? examples/s]Map:  75%|███████▍  | 4000/5334 [00:00<00:00, 28096.75 examples/s]Map: 100%|██████████| 5334/5334 [00:00<00:00, 27900.44 examples/s]
Map:   0%|          | 0/5334 [00:00<?, ? examples/s]Map:  75%|███████▍  | 4000/5334 [00:00<00:00, 27225.84 examples/s]Map: 100%|██████████| 5334/5334 [00:00<00:00, 27249.87 examples/s]
wandb: Currently logged in as: petr-hyner10 to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.19.5
wandb: Run data is saved locally in ./wandb/run-20250324_220115-393yvcez
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Pythia-8-4-512-example-model
wandb: ⭐️ View project at https://wandb.ai/petr-hyner10/example_project
wandb: 🚀 View run at https://wandb.ai/petr-hyner10/example_project/runs/393yvcez
/user-software/venv/pytorch/lib/python3.12/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:654: Checkpoint directory /pfs/lustrep1/scratch/project_465001424/Hyner_Petr/clean_framework/clean_framework/temp/checkpoints/Pythia-8-4-512-example-model exists and is not empty.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
The `GPTNeoXFlashAttention2` class is deprecated in favor of simply modifying the `config._attn_implementation`attribute of the `GPTNeoXAttention` class! It will be removed in v4.48

  0%|          | 0/11 [00:00<?, ?it/s][A
  9%|▉         | 1/11 [00:00<00:05,  1.76it/s][A
 18%|█▊        | 2/11 [00:00<00:03,  2.56it/s][A
 27%|██▋       | 3/11 [00:01<00:02,  2.94it/s][A
 36%|███▋      | 4/11 [00:01<00:02,  3.19it/s][A
 45%|████▌     | 5/11 [00:01<00:01,  3.37it/s][A
 55%|█████▍    | 6/11 [00:01<00:01,  3.49it/s][A
 64%|██████▎   | 7/11 [00:02<00:01,  3.58it/s][A
 73%|███████▎  | 8/11 [00:02<00:00,  3.64it/s][A
 82%|████████▏ | 9/11 [00:02<00:00,  3.68it/s][A
 91%|█████████ | 10/11 [00:02<00:00,  3.71it/s][A
100%|██████████| 11/11 [00:03<00:00,  4.01it/s][A100%|██████████| 11/11 [00:03<00:00,  3.46it/s]
/user-software/venv/pytorch/lib/python3.12/site-packages/lightning/pytorch/loops/fit_loop.py:310: The number of training batches (13) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 15.35it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 15.45it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 15.50it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 15.50it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 15.53it/s][A[A100%|██████████| 11/11 [00:00<00:00, 16.21it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 15.26it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 15.37it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 15.39it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 15.41it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 15.43it/s][A[A100%|██████████| 11/11 [00:00<00:00, 16.11it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 12.15it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 12.17it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 12.21it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 12.24it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 12.31it/s][A[A100%|██████████| 11/11 [00:00<00:00, 12.76it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 12.47it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 12.53it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 12.56it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 12.56it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 12.60it/s][A[A100%|██████████| 11/11 [00:00<00:00, 13.07it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 12.39it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 12.46it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 12.46it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 12.50it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 12.50it/s][A[A100%|██████████| 11/11 [00:00<00:00, 12.99it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 12.43it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 12.52it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 12.54it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 12.56it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 12.60it/s][A[A100%|██████████| 11/11 [00:00<00:00, 13.07it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 12.41it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 12.53it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 12.54it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 12.57it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 12.61it/s][A[A100%|██████████| 11/11 [00:00<00:00, 13.07it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 12.44it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 12.48it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 12.51it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 12.54it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 12.33it/s][A[A100%|██████████| 11/11 [00:00<00:00, 12.85it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 12.41it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 12.49it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 12.53it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 12.54it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 12.55it/s][A[A100%|██████████| 11/11 [00:00<00:00, 13.02it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 12.42it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 12.51it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 12.54it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 12.56it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 12.58it/s][A[A100%|██████████| 11/11 [00:00<00:00, 13.05it/s]


  0%|          | 0/11 [00:00<?, ?it/s][A[A

 18%|█▊        | 2/11 [00:00<00:00, 12.41it/s][A[A

 36%|███▋      | 4/11 [00:00<00:00, 12.52it/s][A[A

 55%|█████▍    | 6/11 [00:00<00:00, 12.52it/s][A[A

 73%|███████▎  | 8/11 [00:00<00:00, 12.55it/s][A[A

 91%|█████████ | 10/11 [00:00<00:00, 12.55it/s][A[A100%|██████████| 11/11 [00:00<00:00, 13.04it/s]
slurmstepd: error: *** JOB 10017556 ON nid005040 CANCELLED AT 2025-03-24T22:03:56 ***
